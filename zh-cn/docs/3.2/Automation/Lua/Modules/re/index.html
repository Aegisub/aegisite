<!DOCTYPE html>
<html>

<!-- Mirrored from aegi.vmoe.info/docs/3.2/Automation/Lua/Modules/re/ by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 24 Jun 2022 03:14:41 GMT -->
<head>
<meta charset='utf-8'>
<title>re - Aegisub 手册</title>
<meta content='Aegisub, 字幕, VSFilter, Medusa, Sabbu, Vmoe, ' name='Keywords'>
<meta content='https://aegi.vmoe.info/' name='Author'>
<meta content='Copyright (C) 2012 Aegisub Project. Chinese translation by Vmoe Fansub.' name='Copyright'>
<meta content='width=device-width, initial-scale=1.0' name='viewport'>
<link href='index.html' rel='canonical'>
<link href="../../../../img/favicon.ico" rel="icon" type="image/ico" />
<link href="../../../../css/style-91e1dc35.css" media="screen" rel="stylesheet" type="text/css" />
</head>
<body>
<div class='navbar navbar-fixed-top'>
<div class='navbar-inner'>
<div class='container-fluid'>
<a class="brand" style="padding: 3px 10px" href="https://aegi.vmoe.info/"><img alt="Aegisub" width="82" height="33" src="../../../../img/logo-top-bar-aeef0634.png" />
</a>
<ul class='nav'>
<li>
<a href="https://aegi.vmoe.info/">主页</a>
</li>
<li>
<a href="http://blog.aegisub.org/">新闻</a>
</li>
<li>
<a href="https://aegi.vmoe.info/downloads/">下载</a>
</li>
<li class='active'>
<a href="https://aegi.vmoe.info/docs/">手册</a>
</li>
<li>
<a href="http://devel.aegisub.org/">报告Bug</a>
</li>
<li>
<a href="http://forum.aegisub.org/">论坛</a>
</li>
<li>
<a href="irc://irc.rizon.net/aegisub">IRC</a>
</li>
</ul>
<ul class='nav pull-right'>
<li>
<form action='https://www.paypal.com/cgi-bin/webscr' method='post' style='padding: 13px 0 6px 0; margin: 0' target='_top'>
<input name='cmd' type='hidden' value='_s-xclick'>
<input name='encrypted' type='hidden' value='-----BEGIN PKCS7-----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-----END PKCS7-----
'>
<input alt='PayPal - The safer, easier way to pay online!' border='0' name='submit' src='https://www.paypalobjects.com/zh_CN/i/btn/btn_donate_SM.gif' type='image'>
<img alt='' border='0' height='1' src='https://www.paypalobjects.com/en_US/i/scr/pixel.gif' width='1'>
</form>
</li>
<li>
<a href='http://flattr.com/thing/922938/Aegisub-Advanced-Subtitle-Editor' target='_blank'>
<img alt='Flattr this' src='https://flattr.com/' title='Flattr this'>
</a>
</li>
</ul>
</div>
</div>
</div>
<div class='fluid-row'>
<div class='span3'>
<ul id='manual-sidebar'>
<li class='nav-header'>导航</li>
<li>
<a href="../../../../Main_Page/index.html">主页</a>
</li>
<li class='nav-header'>介绍</li>
<li>
<a href="../../../../About/index.html">Aegisub 是什么？</a>
</li>
<li>
<a href="../../../../Highlights/index.html">亮点</a>
</li>
<li>
<a href="../../../../Credits/index.html">贡献者</a>
</li>
<li>
<a href="../../../../Support/index.html">支持 Aegisub</a>
</li>
<li>
<a href="../../../../FAQ/index.html">FAQ</a>
</li>
<li>
<a href="../../../../Tutorials/index.html">教程</a>
</li>
<li class='nav-header'>制作字幕</li>
<li>
<a href="../../../../Editing_Subtitles/index.html">编辑字幕</a>
</li>
<li>
<a href="../../../../Exporting/index.html">导出字幕</a>
</li>
<li>
<a href="../../../../Attaching_subtitles_to_video/index.html">应用字幕</a>
</li>
<li>
<a href="../../../../Spell_Checker/index.html">拼写检查器</a>
</li>
<li>
<a href="../../../../Translation_Assistant/index.html">翻译助手</a>
</li>
<li>
<a href="../../../../Paste_Over/index.html">选择性粘贴</a>
</li>
<li>
<a href="../../../../Select_Lines/index.html">选择多行</a>
</li>
<li class='nav-header'>排版</li>
<li>
<a href="../../../../Typesetting/index.html">介绍</a>
</li>
<li>
<a href="../../../../Video/index.html">使用视频</a>
</li>
<li>
<a href="../../../../Styles/index.html">编辑样式</a>
</li>
<li>
<a href="../../../../Visual_Typesetting/index.html">可视化排版</a>
</li>
<li>
<a href="../../../../ASS_Tags/index.html">ASS特效标签</a>
</li>
<li>
<a href="../../../../Colour_Picker/index.html">颜色选择器</a>
</li>
<li>
<a href="../../../../Styling_Assistant/index.html">样式助手</a>
</li>
<li>
<a href="../../../../Resolution_Resampler/index.html">重设分辨率</a>
</li>
<li>
<a href="../../../../Fonts_Collector/index.html">字体收集器</a>
</li>
<li class='nav-header'>时间轴</li>
<li>
<a href="../../../../Audio/index.html">载入音频</a>
</li>
<li>
<a href="../../../../Timing/index.html">使用音频打轴</a>
</li>
<li>
<a href="../../../../Shift_Times/index.html">平移时间</a>
</li>
<li>
<a href="../../../../Timing_Post-Processor/index.html">时间后续处理器</a>
</li>
<li>
<a href="../../../../Kanji_Timer/index.html">汉字计时器</a>
</li>
<li class='nav-header'>自动化</li>
<li>
<a href="../../../index.html">概述</a>
</li>
<li>
<a href="../../../Karaoke_Templater/index.html">卡拉OK模版</a>
</li>
<li>
<a href="../../index.html">Lua 相关</a>
</li>
<li class='nav-header'>杂项</li>
<li>
<a href="../../../../Options/index.html">Aegisub选项</a>
</li>
<li>
<a href="../../../../Properties/index.html">脚本配置</a>
</li>
<li>
<a href="../../../../Attachment_Manager/index.html">附件管理器</a>
</li>
</ul>
</div>
<div class='span9' id='manual-body'>
<h1 class='page-header'>re</h1>
<ol id="markdown-toc">
  <li><a id="markdown-toc-section" href="#section">用法</a>    <ol>
      <li><a id="markdown-toc-section-1" href="#section-1">匹配表</a></li>
      <li><a id="markdown-toc-flags" href="#flags">Flags</a></li>
      <li><a id="markdown-toc-recompile" href="#recompile">re.compile</a></li>
      <li><a id="markdown-toc-resplit" href="#resplit">re.split</a></li>
      <li><a id="markdown-toc-regsplit" href="#regsplit">re.gsplit</a></li>
      <li><a id="markdown-toc-refind" href="#refind">re.find</a></li>
      <li><a id="markdown-toc-regfind" href="#regfind">re.gfind</a></li>
      <li><a id="markdown-toc-rematch" href="#rematch">re.match</a></li>
      <li><a id="markdown-toc-regmatch" href="#regmatch">re.gmatch</a></li>
      <li><a id="markdown-toc-resub" href="#resub">re.sub</a></li>
    </ol>
  </li>
</ol>

<p><code>re</code> 模块是封装过的 boost::regex，加入它的意图是为了取代Lua内置的正则表达式。相比Lua内置的正则，它有两个主要优点:</p>

<ol>
  <li>完整的 Unicode 支持。Lua 正则对字节进行操作，而不是字符，这在我们处理多字节字符时时常引起问题。</li>
  <li>更强大和灵活的表达式。严格地说，Lua 不支持正则表达式；它只是拥有一个较小的模式匹配语言，只能实现正则表达式的部分功能。
 boost::regex 则完整兼容PRCE标准的正则表达式。</li>
</ol>

<h2 id="section">用法</h2>
<p>使用 <code><span class="n">re</span> <span class="o">=</span> <span class="nb">require</span> <span class="s1">'aegisub.re'</span></code> 导入该模块。</p>

<p>查阅 <a href="http://www.boost.org/doc/libs/1_53_0/libs/regex/doc/html/boost_regex/syntax/perl_syntax.html">boost.regex's
documentation</a>
以获取更多有关正则表达式的信息。总地来说，你在互联网上能找到的任何有关PRCE正则表达式的教程都可以作为这个模块的使用参考。</p>

<h3 id="section-1">匹配表</h3>
<p>以下的几个函数会返回匹配表(以表的形式返回匹配)，表的结构如下：</p>

<dl>
  <dt><strong><code>str</code></strong> (<code>string</code>)</dt>
  <dd>匹配到的文本。</dd>
  <dt><strong><code>first</code></strong> (<code>number</code>)</dt>
  <dd>匹配到的 <code>str</code> 在原字符串中首次出现的位置。
这个位置是基于字节计算的，从1开始记，而不是按字符算，这是为了与Lua的字符串计数相匹配。</dd>
  <dt><strong><code>last</code></strong> (<code>number</code>)</dt>
  <dd>匹配到的 <code>str</code> 在原字符串中最后出现的位置。</dd>
</dl>

<div class='examplebox'>
<div class='exampleheader'>Example</div>
<div class='examplecontents'><div class="highlight"><pre class="codehilite"><code><span class="o">&gt;&gt;&gt;</span> <span class="n">re</span><span class="p">.</span><span class="n">match</span><span class="p">(</span><span class="s2">"b"</span><span class="p">,</span> <span class="s2">"abc"</span><span class="p">)</span>
<span class="p">{</span>
    <span class="p">{</span>
        <span class="p">[</span><span class="s2">"str"</span><span class="p">]</span> <span class="o">=</span> <span class="s2">"b"</span><span class="p">,</span>
        <span class="p">[</span><span class="s2">"first"</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
        <span class="p">[</span><span class="s2">"last"</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="p">}</span>
<span class="p">}</span></code></pre></div></div>
</div>

<h3 id="flags">Flags</h3>
<p>The following flags may be passed to all of the static functions (including
<code>re.compile</code>).  Flags must come after all supplied non-flag arguments, but
optional arguments can be skipped.</p>

<dl>
  <dt>re.ICASE</dt>
  <dd>Ignore case when matching.</dd>
  <dt>re.NOSUB:</dt>
  <dd>Don't set backreferences and capture groups. Can improve performance when
they aren't needed.</dd>
  <dt>re.NEWLINE_ALT:</dt>
  <dd>Treat newline characters as the alternation operator (|).</dd>
  <dt>re.NO_MOD_M:</dt>
  <dd>^ and $ only match the beginning and end of the string rather than newlines.</dd>
  <dt>re.MOD_S:</dt>
  <dd>Treat newlines as normal characters, matched by '.'.</dd>
  <dt>re.MOD_X:</dt>
  <dd>Ignore unescaped whitespace in the expression, making it possible to write
regular expressions that <em>aren't</em> write-only.</dd>
  <dt>re.NO_EMPTY_SUBEXPRESSION:</dt>
  <dd>Don't match empty expressions/alternatives.</dd>
</dl>

<div class='examplebox'>
<div class='exampleheader'>Example</div>
<div class='examplecontents'><div class="highlight"><pre class="codehilite"><code><span class="o">&gt;&gt;&gt;</span> <span class="n">re</span><span class="p">.</span><span class="n">match</span><span class="p">(</span><span class="s2">"a"</span><span class="p">,</span> <span class="s2">"A"</span><span class="p">)</span>
<span class="kc">nil</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">re</span><span class="p">.</span><span class="n">match</span><span class="p">(</span><span class="s2">"a"</span><span class="p">,</span> <span class="s2">"A"</span><span class="p">,</span> <span class="n">re</span><span class="p">.</span><span class="n">ICASE</span><span class="p">,</span> <span class="n">re</span><span class="p">.</span><span class="n">NOSUB</span><span class="p">)</span>
<span class="p">{</span>
    <span class="p">{</span>
        <span class="p">[</span><span class="s2">"str"</span><span class="p">]</span> <span class="o">=</span> <span class="s2">"A"</span><span class="p">,</span>
        <span class="p">[</span><span class="s2">"first"</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
        <span class="p">[</span><span class="s2">"last"</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="p">}</span>
<span class="p">}</span></code></pre></div></div>
</div>

<h3 id="recompile">re.compile</h3>
<p>Synopsis: <code><span class="n">expr</span> <span class="o">=</span> <span class="n">re</span><span class="p">.</span><span class="n">compile</span><span class="p">(</span><span class="n">pattern</span><span class="p">,</span> <span class="p">[</span><span class="n">FLAGS</span><span class="p">])</span></code></p>

<p>Compile a regular expression. Reusing a compiled regular expression is faster
than recompiling it each time it is used, and is usually more readable as well.</p>

<dl>
  <dt><strong><code>@pattern</code></strong> (<code>string</code>)</dt>
  <dd>Regular expression to compile.</dd>
  <dt><strong><code>expr</code></strong> (<code>table</code>)</dt>
  <dd>A table with all of the functions listed below, except without the pattern
and flags arguments.</dd>
</dl>

<div class='examplebox'>
<div class='exampleheader'>Example</div>
<div class='examplecontents'><div class="highlight"><pre class="codehilite"><code><span class="o">&gt;&gt;&gt;</span> <span class="n">expr</span> <span class="o">=</span> <span class="n">re</span><span class="p">.</span><span class="n">compile</span><span class="p">(</span><span class="s2">"a"</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">expr</span><span class="p">:</span><span class="n">split</span><span class="p">(</span><span class="s2">"banana"</span><span class="p">)</span>
<span class="p">{</span>
    <span class="s2">"b"</span><span class="p">,</span>
    <span class="s2">"n"</span><span class="p">,</span>
    <span class="s2">"n"</span>
<span class="p">}</span></code></pre></div></div>
</div>

<h3 id="resplit">re.split</h3>
<p>Synopsis: <code><span class="n">chunks</span> <span class="o">=</span> <span class="n">re</span><span class="p">.</span><span class="n">split</span><span class="p">(</span><span class="n">str</span><span class="p">,</span> <span class="n">pattern</span><span class="p">,</span> <span class="n">skip_empty</span><span class="o">=</span><span class="kc">false</span><span class="p">,</span> <span class="n">max_splits</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span></code></p>

<p>Split the string at each of the occurrences of <code>pattern</code>.</p>

<dl>
  <dt><strong><code>@str</code></strong> (<code>string</code>)</dt>
  <dd>String to split.</dd>
  <dt><strong><code>@pattern</code></strong> (<code>string</code>)</dt>
  <dd>Regular expression to split the string on. Capturing groups in the pattern
are ignored.</dd>
  <dt><strong><code>@skip_empty</code></strong> (<code>boolean</code>)</dt>
  <dd>Do not include zero-length chunks in the results.</dd>
  <dt><strong><code>@max_splits</code></strong> (<code>number</code>)</dt>
  <dd>If greater than zero, the maximum numbers of times to split the string (i.e.
<code>#chunks</code> will be at most <code>max_splits + 1</code>).</dd>
  <dt><strong><code>chunks</code></strong> (<code>table</code>)</dt>
  <dd>A table containing each of the sections of <code>str</code> between the matches of
<code>pattern</code>.</dd>
</dl>

<div class='examplebox'>
<div class='exampleheader'>Example</div>
<div class='examplecontents'><div class="highlight"><pre class="codehilite"><code><span class="o">&gt;&gt;&gt;</span> <span class="n">re</span><span class="p">.</span><span class="n">split</span><span class="p">(</span><span class="s2">","</span><span class="p">,</span> <span class="s2">"a,,b,c"</span><span class="p">)</span>
<span class="p">{</span>
    <span class="s2">"a"</span><span class="p">,</span>
    <span class="s2">""</span><span class="p">,</span>
    <span class="s2">"b"</span><span class="p">,</span>
    <span class="s2">"c"</span>
<span class="p">}</span></code></pre></div></div>
</div>
<div class='examplebox'>
<div class='exampleheader'>Example</div>
<div class='examplecontents'><div class="highlight"><pre class="codehilite"><code><span class="o">&gt;&gt;&gt;</span> <span class="n">re</span><span class="p">.</span><span class="n">split</span><span class="p">(</span><span class="s2">","</span><span class="p">,</span> <span class="s2">"a,,b,c"</span><span class="p">,</span> <span class="kc">true</span><span class="p">)</span>
<span class="p">{</span>
    <span class="s2">"a"</span><span class="p">,</span>
    <span class="s2">"b"</span><span class="p">,</span>
    <span class="s2">"c"</span>
<span class="p">}</span></code></pre></div></div>
</div>
<div class='examplebox'>
<div class='exampleheader'>Example</div>
<div class='examplecontents'><div class="highlight"><pre class="codehilite"><code><span class="o">&gt;&gt;&gt;</span> <span class="n">re</span><span class="p">.</span><span class="n">split</span><span class="p">(</span><span class="s2">","</span><span class="p">,</span> <span class="s2">"a,,b,c"</span><span class="p">,</span> <span class="kc">false</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="p">{</span>
    <span class="s2">"a"</span><span class="p">,</span>
    <span class="s2">",b,c"</span><span class="p">,</span>
<span class="p">}</span></code></pre></div></div>
</div>

<h3 id="regsplit">re.gsplit</h3>
<p>Synopsis: <code><span class="n">iter</span> <span class="o">=</span> <span class="n">re</span><span class="p">.</span><span class="n">gsplit</span><span class="p">(</span><span class="n">str</span><span class="p">,</span> <span class="n">pattern</span><span class="p">,</span> <span class="n">skip_empty</span><span class="o">=</span><span class="kc">false</span><span class="p">,</span> <span class="n">max_splits</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span></code></p>

<p>Iterator version of re.split.</p>

<dl>
  <dt><strong><code>@str</code></strong> (<code>string</code>)</dt>
  <dd>String to split.</dd>
  <dt><strong><code>@pattern</code></strong> (<code>string</code>)</dt>
  <dd>Regular expression to split the string on. Capturing groups in the pattern
are ignored.</dd>
  <dt><strong><code>@skip_empty</code></strong> (<code>boolean</code>)</dt>
  <dd>Do not include zero-length chunks in the results.</dd>
  <dt><strong><code>@max_splits</code></strong> (<code>number</code>)</dt>
  <dd>If greater than zero, the maximum numbers of times to split the string (i.e.
<code>#chunks</code> will be at most <code>max_splits + 1</code>).</dd>
  <dt><strong><code>iter</code></strong> (<code>iterator over strings</code>)</dt>
  <dd>An iterator over each of the sections of <code>str</code> between the matches of
<code>pattern</code>.</dd>
</dl>

<div class='examplebox'>
<div class='exampleheader'>Example</div>
<div class='examplecontents'><div class="highlight"><pre class="codehilite"><code><span class="o">&gt;&gt;&gt;</span> <span class="k">for</span> <span class="n">str</span> <span class="k">in</span> <span class="n">re</span><span class="p">.</span><span class="n">gsplit</span><span class="p">(</span><span class="s2">","</span><span class="p">,</span> <span class="s2">"a,,b,c"</span><span class="p">)</span> <span class="k">do</span>
<span class="o">&gt;&gt;&gt;</span>     <span class="nb">print</span> <span class="n">str</span>
<span class="o">&gt;&gt;&gt;</span> <span class="k">end</span>
<span class="n">a</span>

<span class="n">b</span>
<span class="n">c</span></code></pre></div></div>
</div>
<div class='examplebox'>
<div class='exampleheader'>Example</div>
<div class='examplecontents'><div class="highlight"><pre class="codehilite"><code><span class="o">&gt;&gt;&gt;</span> <span class="k">for</span> <span class="n">str</span> <span class="k">in</span> <span class="n">re</span><span class="p">.</span><span class="n">gsplit</span><span class="p">(</span><span class="s2">","</span><span class="p">,</span> <span class="s2">"a,,b,c"</span><span class="p">,</span> <span class="kc">true</span><span class="p">)</span> <span class="k">do</span>
<span class="o">&gt;&gt;&gt;</span>     <span class="nb">print</span> <span class="n">str</span>
<span class="o">&gt;&gt;&gt;</span> <span class="k">end</span>
<span class="n">a</span>
<span class="n">b</span>
<span class="n">c</span></code></pre></div></div>
</div>
<div class='examplebox'>
<div class='exampleheader'>Example</div>
<div class='examplecontents'><div class="highlight"><pre class="codehilite"><code><span class="o">&gt;&gt;&gt;</span> <span class="k">for</span> <span class="n">str</span> <span class="k">in</span> <span class="n">re</span><span class="p">.</span><span class="n">gsplit</span><span class="p">(</span><span class="s2">","</span><span class="p">,</span> <span class="s2">"a,,b,c"</span><span class="p">,</span> <span class="kc">false</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="k">do</span>
<span class="o">&gt;&gt;&gt;</span>     <span class="nb">print</span> <span class="n">str</span>
<span class="o">&gt;&gt;&gt;</span> <span class="k">end</span>
<span class="n">a</span>
<span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">c</span></code></pre></div></div>
</div>

<h3 id="refind">re.find</h3>
<p>Synopsis: <code><span class="n">matches</span> <span class="o">=</span> <span class="n">re</span><span class="p">.</span><span class="n">find</span><span class="p">(</span><span class="n">str</span><span class="p">,</span> <span class="n">pattern</span><span class="p">)</span></code></p>

<p>Find all non-overlapping substrings of <code>str</code> which match <code>pattern</code>.</p>

<dl>
  <dt><strong><code>@str</code></strong> (<code>string</code>)</dt>
  <dd>String to search for the pattern in.</dd>
  <dt><strong><code>@pattern</code></strong> (<code>string</code>)</dt>
  <dd>Pattern to search for. Capturing groups in the pattern are ignored.</dd>
  <dt><strong><code>matches</code></strong> (<code>table</code> or <code>nil</code>)</dt>
  <dd>A table of <a href="index.html#match-tables">Match Tables</a> for all matches, or <code>nil</code> if
there were none.</dd>
</dl>

<div class='examplebox'>
<div class='exampleheader'>Example</div>
<div class='examplecontents'><div class="highlight"><pre class="codehilite"><code><span class="o">&gt;&gt;&gt;</span> <span class="n">re</span><span class="p">.</span><span class="n">find</span><span class="p">(</span><span class="s2">"."</span><span class="p">,</span> <span class="s2">"☃☃"</span><span class="p">)</span>
<span class="p">{</span>
    <span class="p">{</span>
        <span class="p">[</span><span class="s2">"str"</span><span class="p">]</span> <span class="o">=</span> <span class="s2">"☃"</span><span class="p">,</span>
        <span class="p">[</span><span class="s2">"first"</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
        <span class="p">[</span><span class="s2">"last"</span><span class="p">]</span> <span class="o">=</span> <span class="mi">3</span>
    <span class="p">},</span>
    <span class="p">{</span>
        <span class="p">[</span><span class="s2">"str"</span><span class="p">]</span> <span class="o">=</span> <span class="s2">"☃"</span><span class="p">,</span>
        <span class="p">[</span><span class="s2">"first"</span><span class="p">]</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span>
        <span class="p">[</span><span class="s2">"last"</span><span class="p">]</span> <span class="o">=</span> <span class="mi">6</span>
    <span class="p">}</span>
<span class="p">}</span></code></pre></div></div>
</div>
<div class='examplebox'>
<div class='exampleheader'>Example</div>
<div class='examplecontents'><div class="highlight"><pre class="codehilite"><code><span class="k">function</span> <span class="nf">contains_an_a</span><span class="p">(</span><span class="n">str</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">re</span><span class="p">.</span><span class="n">find</span><span class="p">(</span><span class="s2">"a"</span><span class="p">,</span> <span class="n">str</span><span class="p">)</span>
        <span class="nb">print</span> <span class="s2">"Has an a"</span>
    <span class="k">else</span>
        <span class="nb">print</span> <span class="s2">"Doesn't have an a"</span>
    <span class="k">end</span>
<span class="k">end</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">contains_an_a</span><span class="p">(</span><span class="s2">"abc"</span><span class="p">)</span>
<span class="n">Has</span> <span class="n">an</span> <span class="n">a</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">contains_an_a</span><span class="p">(</span><span class="s2">"def"</span><span class="p">)</span>
<span class="n">Doesn</span><span class="s1">'t have an a</span></code></pre></div></div>
</div>

<h3 id="regfind">re.gfind</h3>
<p>Synopsis: <code><span class="n">iter</span> <span class="o">=</span> <span class="n">re</span><span class="p">.</span><span class="n">gfind</span><span class="p">(</span><span class="n">str</span><span class="p">,</span> <span class="n">pattern</span><span class="p">)</span></code></p>

<p>Iterate over all non-overlapping substrings of <code>str</code> which match <code>pattern</code>.</p>

<dl>
  <dt><strong><code>@str</code></strong> (<code>string</code>)</dt>
  <dd>String to search for the pattern in.</dd>
  <dt><strong><code>@pattern</code></strong> (<code>string</code>)</dt>
  <dd>Pattern to search for. Capturing groups in the pattern are ignored.</dd>
  <dt><strong><code>iter</code></strong> (<code>iterator over string, number, number</code>)</dt>
  <dd>An iterator which produces three values at each step: a matched string, the
started index of the match in the source string, and the inclusive end index of
the match in the source string.</dd>
</dl>

<div class='examplebox'>
<div class='exampleheader'>Example</div>
<div class='examplecontents'><div class="highlight"><pre class="codehilite"><code><span class="o">&gt;&gt;&gt;</span> <span class="k">for</span> <span class="n">str</span><span class="p">,</span> <span class="n">start_idx</span><span class="p">,</span> <span class="n">end_idx</span> <span class="k">in</span> <span class="n">re</span><span class="p">.</span><span class="n">gfind</span><span class="p">(</span><span class="s2">"."</span><span class="p">,</span> <span class="s2">"☃☃"</span><span class="p">)</span> <span class="k">do</span>
<span class="o">&gt;&gt;&gt;</span>     <span class="nb">print</span> <span class="nb">string.format</span><span class="p">(</span><span class="s2">"%d-%d: %s"</span><span class="p">,</span> <span class="n">start_idx</span><span class="p">,</span> <span class="n">end_idx</span><span class="p">,</span> <span class="n">str</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="k">end</span>
<span class="mi">1</span><span class="o">-</span><span class="mi">3</span><span class="p">:</span> <span class="err">☃</span>
<span class="mi">4</span><span class="o">-</span><span class="mi">6</span><span class="p">:</span> <span class="err">☃</span></code></pre></div></div>
</div>

<h3 id="rematch">re.match</h3>
<p>Synopsis: <code><span class="n">matches</span> <span class="o">=</span> <span class="n">re</span><span class="p">.</span><span class="n">match</span><span class="p">(</span><span class="n">str</span><span class="p">,</span> <span class="n">pattern</span><span class="p">)</span></code></p>

<p>Match a pattern against a string. This differs from <code>find</code> in that <code>find</code>
returns all matches and does not capture subgroups, while this returns only a
single match along with the captured subgroups.</p>

<dl>
  <dt><strong><code>@str</code></strong> (<code>string</code>)</dt>
  <dd>String to search for the pattern in.</dd>
  <dt><strong><code>@pattern</code></strong> (<code>string</code>)</dt>
  <dd>Pattern to search for.</dd>
  <dt><strong><code>matches</code></strong> (<code>table</code> or <code>nil</code>)</dt>
  <dd><code>nil</code> if the pattern did not match the string. Otherwise, a table containing
a <a href="index.html#match-tables">Match Table</a> for the full match, followed by a <a href="index.html#match-tables">Match
Table</a> for each capturing subexpression in the pattern (if
any).</dd>
</dl>

<div class='examplebox'>
<div class='exampleheader'>Example</div>
<div class='examplecontents'><div class="highlight"><pre class="codehilite"><code><span class="o">&gt;&gt;&gt;</span> <span class="n">re</span><span class="p">.</span><span class="n">match</span><span class="p">(</span><span class="s2">"(\d+) (\d+) (\d+)"</span><span class="p">,</span> <span class="s2">"{250 1173 380}Help!"</span><span class="p">)</span>
<span class="p">{</span>
    <span class="p">{</span>
        <span class="p">[</span><span class="s2">"str"</span><span class="p">]</span> <span class="o">=</span> <span class="s2">"250 1173 380"</span><span class="p">,</span>
        <span class="p">[</span><span class="s2">"first"</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
        <span class="p">[</span><span class="s2">"last"</span><span class="p">]</span> <span class="o">=</span> <span class="mi">13</span>
    <span class="p">},</span>
    <span class="p">{</span>
        <span class="p">[</span><span class="s2">"str"</span><span class="p">]</span> <span class="o">=</span> <span class="s2">"250"</span><span class="p">,</span>
        <span class="p">[</span><span class="s2">"first"</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
        <span class="p">[</span><span class="s2">"last"</span><span class="p">]</span> <span class="o">=</span> <span class="mi">4</span>
    <span class="p">},</span>
    <span class="p">{</span>
        <span class="p">[</span><span class="s2">"str"</span><span class="p">]</span> <span class="o">=</span> <span class="s2">"1173"</span><span class="p">,</span>
        <span class="p">[</span><span class="s2">"first"</span><span class="p">]</span> <span class="o">=</span> <span class="mi">6</span><span class="p">,</span>
        <span class="p">[</span><span class="s2">"last"</span><span class="p">]</span> <span class="o">=</span> <span class="mi">9</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="p">{</span>
        <span class="p">[</span><span class="s2">"str"</span><span class="p">]</span> <span class="o">=</span> <span class="s2">"380"</span>
        <span class="p">[</span><span class="s2">"first"</span><span class="p">]</span> <span class="o">=</span> <span class="mi">11</span><span class="p">,</span>
        <span class="p">[</span><span class="s2">"last"</span><span class="p">]</span> <span class="o">=</span> <span class="mi">13</span>
    <span class="p">}</span>
<span class="p">}</span></code></pre></div></div>
</div>

<h3 id="regmatch">re.gmatch</h3>
<p>Synopsis: <code><span class="n">iter</span> <span class="o">=</span> <span class="n">re</span><span class="p">.</span><span class="n">gmatch</span><span class="p">(</span><span class="n">str</span><span class="p">,</span> <span class="n">pattern</span><span class="p">)</span></code></p>

<p>Iterator version of <a href="index.html#re.match">`re.match`</a>.</p>

<dl>
  <dt><strong><code>@str</code></strong> (<code>string</code>)</dt>
  <dd>String to search for the pattern in.</dd>
  <dt><strong><code>@pattern</code></strong> (<code>string</code>)</dt>
  <dd>Pattern to search for.</dd>
  <dt><strong><code>matches</code></strong> (<code>iterator over table</code>)</dt>
  <dd>An iterator which returns a table containing a <a href="index.html#match-tables">Match
Table</a> for the full match (if it matched), followed by a
<a href="index.html#match-tables">Match Table</a> for each capturing subexpression in the pattern
(if any).</dd>
</dl>

<h3 id="resub">re.sub</h3>
<p>Synopsis: <code><span class="n">out_str</span><span class="p">,</span> <span class="n">rep_count</span> <span class="o">=</span> <span class="n">re</span><span class="p">.</span><span class="n">sub</span><span class="p">(</span><span class="n">str</span><span class="p">,</span> <span class="n">replace</span><span class="p">,</span> <span class="n">pattern</span><span class="p">,</span> <span class="n">max_count</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span></code></p>

<p>Replace each occurrence of <code>pattern</code> in <code>str</code> with <code>replace</code>.</p>

<dl>
  <dt><strong><code>@pattern</code></strong> (<code>string</code>)</dt>
  <dd>Pattern to search for.</dd>
  <dt><strong><code>@replace</code></strong> (<code>string</code> or <code>function</code>)</dt>
  <dd>Replacement for matches. This may be either a string which is inserted, or a
  function which is called for each match.

    <p>If <code>replace</code> is a string, it may contain references to the matches. <code>&amp;</code> and
  <code>\0</code> are replaced with the full match, and <code>\&lt;number&gt;</code> is replaced with the
  appropriate captured subexpression.</p>

    <p>If <code>replace</code> is a function, it is called for either the entire match (if
  there are no capturing subexpressions), or for each captured subexpression.
  It is passed the match string, start index of the match, and end index of
  the match. If it returns a string, the match is replaced with the return
  value. If it returns anything else, then the source string is left
  unchanged.</p>
  </dd>
  <dt><strong><code>@max_count</code></strong> (<code>number</code>)</dt>
  <dd>If greater than zero, the maximum number of replacements to make.</dd>
  <dt><strong><code>out_str</code></strong> (<code>string</code>)</dt>
  <dd>The input string, with replacements applied.</dd>
  <dt><strong><code>rep_count</code></strong> (<code>number</code>)</dt>
  <dd>The number of replacements that were made.</dd>
</dl>

<div class='examplebox'>
<div class='exampleheader'>Example</div>
<div class='examplecontents'><p>Replace all instances of \k with \kf:</p>

<div class="highlight"><pre class="highlight lua"><code><span class="o">&gt;&gt;&gt;</span> <span class="n">re</span><span class="p">.</span><span class="n">sub</span><span class="p">(</span><span class="s2">"{\\k10}a{\\k15}b{\\k30}c"</span><span class="p">,</span> <span class="s2">"</span><span class="se">\\\\</span><span class="s2">k"</span><span class="p">,</span> <span class="s2">"</span><span class="se">\\</span><span class="s2">kf"</span><span class="p">)</span>
<span class="p">{</span><span class="err">\</span><span class="n">kf10</span><span class="p">}</span><span class="n">a</span><span class="p">{</span><span class="err">\</span><span class="n">kf15</span><span class="p">}</span><span class="n">b</span><span class="p">{</span><span class="err">\</span><span class="n">kf30</span><span class="p">}</span><span class="n">c</span>
</code></pre></div></div>
</div>
<div class='examplebox'>
<div class='exampleheader'>Example</div>
<div class='examplecontents'><p>Replace all instances of \k and \K with \kf:</p>

<div class="highlight"><pre class="highlight lua"><code><span class="o">&gt;&gt;&gt;</span> <span class="n">re</span><span class="p">.</span><span class="n">sub</span><span class="p">(</span><span class="s2">"{\\K10}a{\\K15}b{\\k30}c"</span><span class="p">,</span> <span class="s2">"</span><span class="se">\\\\</span><span class="s2">k"</span><span class="p">,</span> <span class="s2">"</span><span class="se">\\</span><span class="s2">kf"</span><span class="p">,</span> <span class="n">re</span><span class="p">.</span><span class="n">ICASE</span><span class="p">)</span>
<span class="p">{</span><span class="err">\</span><span class="n">kf10</span><span class="p">}</span><span class="n">a</span><span class="p">{</span><span class="err">\</span><span class="n">kf15</span><span class="p">}</span><span class="n">b</span><span class="p">{</span><span class="err">\</span><span class="n">kf30</span><span class="p">}</span><span class="n">c</span>
</code></pre></div></div>
</div>
<div class='examplebox'>
<div class='exampleheader'>Example</div>
<div class='examplecontents'><p>Add one to each \k duration:</p>

<div class="highlight"><pre class="highlight lua"><code><span class="k">function</span> <span class="nf">add_one</span><span class="p">(</span><span class="n">str</span><span class="p">)</span>
    <span class="k">return</span> <span class="nb">tostring</span><span class="p">(</span><span class="nb">tonumber</span><span class="p">(</span><span class="n">str</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="k">end</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">re</span><span class="p">.</span><span class="n">sub</span><span class="p">(</span><span class="s2">"{\\k10}a{\\k15}b{\\k30}c"</span><span class="p">,</span> <span class="s2">"</span><span class="se">\\\\</span><span class="s2">k(\[[:digit:]]+)"</span><span class="p">,</span> <span class="n">add_one</span><span class="p">)</span>
<span class="p">{</span><span class="err">\</span><span class="n">k11</span><span class="p">}</span><span class="n">a</span><span class="p">{</span><span class="err">\</span><span class="n">k16</span><span class="p">}</span><span class="n">b</span><span class="p">{</span><span class="err">\</span><span class="n">k31</span><span class="p">}</span><span class="n">c</span>
</code></pre></div></div>
</div>

<div class='navbox'>
<div><a href="../../../index.html">自动化</a></div>
<table>
<tr>
<th>概述:</th>
<td><a href="../../../Manager/index.html">自动化脚本管理器</a> • <a href="../../../Running_macros/index.html">运行宏</a> • <a href="../../../../Exporting/index.html">使用导出滤镜</a> • <a href="../../../Included_macros/index.html">示例宏</a></td>
</tr>
<tr>
<th><a href="../../../Karaoke_Templater/index.html">卡拉OK模版执行器</a> 相关:</th>
<td><a href="../../../Karaoke_Templater/Declaring_template_and_code_lines/index.html">声明模版</a> • <a href="../../../Karaoke_Templater/Template_execution_rules_and_order/index.html">模版执行顺序</a> • <a href="../../../Karaoke_Templater/Template_modifiers/index.html">修饰语</a> • <a href="../../../Karaoke_Templater/Inline_variables/index.html">内联变量($变量)</a> <br> <a href="../../../Karaoke_Templater/Code_lines_and_blocks/index.html">code行和code区</a> • <a href="../../../Karaoke_Templater/Code_execution_environment/index.html">代码执行环境</a></td>
</tr>
<tr>
<th><a href="../../index.html">Lua API</a> 相关:</th>
<td><a href="../../Registration/index.html">注册</a> • <a href="../../Subtitle_file_interface/index.html">字幕对象</a> • <a href="../../Progress_reporting/index.html">进度反馈</a> • <a href="../../Dialogs/index.html">对话框</a> • <a href="../../Miscellaneous_APIs/index.html">其他APIs</a></td>
</tr>
<tr>
<th><a href="../index.html">Lua 模块</a>:</th>
<td><a href="../karaskel.lua/index.html">karaskel.lua</a> • <a href="../util/index.html">util</a> • <a href="../unicode/index.html">unicode</a> • <a href="#">cleantags.lua</a> • <a href="../clipboard/index.html">clipboard</a> • <a href="index.html">re</a></td>
</tr>
<tr>
<th>Karaskel 概念:</th>
<td><a href="../karaskel.lua/index.html#style-table">Style tables</a> • <a href="../karaskel.lua/index.html#dialogue-line-table">Dialogue line tables</a> • <a href="../karaskel.lua/index.html#karaoke-and-furigana-syllable-tables">Syllable tables</a> • <a href="../../../../Karaoke_inline-fx/index.html">内联特效</a> • <a href="../../../../Furigana_karaoke/index.html">注音假名</a></td>
</tr>
</table>
</div>

</div>
</div>

<footer class='footer span12 pagination-centered'>
<p>
Aegisub 非官方中文网站由
<a href='http://vmoe.info/'>Vmoe字幕组</a>
提供支持，不保证内容绝对准确，请以
<a href='http://www.aegisub.org/'>Aegisub 官网</a>
为准。
</p>
</footer>
</body>

<!-- Mirrored from aegi.vmoe.info/docs/3.2/Automation/Lua/Modules/re/ by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 24 Jun 2022 03:14:41 GMT -->
</html>

