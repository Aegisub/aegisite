<!doctype html><html lang=en-US><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="ie=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><script>(()=>{var t=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches,e=localStorage.getItem("theme");t&&e===null&&(localStorage.setItem("theme","dark"),document.documentElement.setAttribute("data-dark-mode","")),t&&e==="dark"&&document.documentElement.setAttribute("data-dark-mode",""),e==="dark"&&document.documentElement.setAttribute("data-dark-mode","")})()</script><link rel=stylesheet href=/main.8eea9b71beda1575310e88d17ac79aea492cb5bff5f5200f7a1c3e1e650663f1a1c936a6654c061c012536cc53ee1bd37565a2870c09d7e287acd0f155bc7148.css integrity="sha512-juqbcb7aFXUxDojResea6kkstb/19SAPehw+HmUGY/GhyTamZUwGHAElNsxT7hvTdWWihwwJ1+KHrNDxVbxxSA==" crossorigin=anonymous><noscript><style>.collapse:not(.show){display:block}button.btn-toggle{cursor:unset}button.btn-toggle::before{display:none}.doks-subnavbar{display:none}</style></noscript><meta name=robots content="index, follow"><meta name=googlebot content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"><meta name=bingbot content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"><title>Three things that Java could learn from C++ - Aegisub</title>
<meta name=description content="This is a mostly off-topic rant that is being posted because I know that a good portion of our user base is composed of programmers.
Ever since I started working with Java, a few months ago, there have been many things that I have felt SHOULD be there, but aren&amp;rsquo;t. Three, in particular, have always bothered me: stack building, operator overloading, and const-correctness. For the rest of this post, I will write snippets in both C++ and in Java to illustrate the differences."><link rel=canonical href=/blog/three-things-that-java-could-learn-from-c-/><meta property="og:locale" content="en_US"><meta property="og:type" content="article"><meta property="og:title" content="Three things that Java could learn from C++"><meta property="og:description" content="This is a mostly off-topic rant that is being posted because I know that a good portion of our user base is composed of programmers.
Ever since I started working with Java, a few months ago, there have been many things that I have felt SHOULD be there, but aren&rsquo;t. Three, in particular, have always bothered me: stack building, operator overloading, and const-correctness. For the rest of this post, I will write snippets in both C++ and in Java to illustrate the differences."><meta property="og:url" content="/blog/three-things-that-java-could-learn-from-c-/"><meta property="og:site_name" content="Aegisub"><meta property="article:published_time" content="2008-11-08T16:03:00+00:00"><meta property="article:modified_time" content="2008-11-08T17:48:32+00:00"><meta property="og:image" content="/img/logo.png"><meta property="og:image:alt" content="Aegisub"><meta name=twitter:card content="summary_large_image"><meta name=twitter:site content="@aegisub"><meta name=twitter:creator content><meta name=twitter:title content="Three things that Java could learn from C++"><meta name=twitter:description content><meta name=twitter:image content="/img/logo.png"><meta name=twitter:image:alt content="Three things that Java could learn from C++"><script type=application/ld+json>{"@context":"https://schema.org","@graph":[{"@type":"Organization","@id":"/#/schema/organization/1","name":"Aegisub","url":"/","sameAs":["https://twitter.com/aegisub","https://github.com/Aegisub/Aegisub"],"logo":{"@type":"ImageObject","@id":"/#/schema/image/1","url":"/logo-aegisub.png","width":512,"height":512,"caption":"Aegisub"},"image":{"@id":"/#/schema/image/1"}},{"@type":"WebSite","@id":"/#/schema/website/1","url":"/","name":"Aegisub","description":"Aegisub is a free, cross-platform open source tool for creating and modifying subtitles. Aegisub makes it quick and easy to time subtitles to audio, and features many powerful tools for styling them, including a built-in real-time video preview.","publisher":{"@id":"/#/schema/organization/1"}},{"@type":"WebPage","@id":"/blog/three-things-that-java-could-learn-from-c-/","url":"/blog/three-things-that-java-could-learn-from-c-/","name":"Three things that Java could learn from C\u002b\u002b","description":"","isPartOf":{"@id":"/#/schema/website/1"},"about":{"@id":"/#/schema/organization/1"},"datePublished":"2008-11-08T16:03:00CET","dateModified":"2008-11-08T17:48:32CET","breadcrumb":{"@id":"/blog/three-things-that-java-could-learn-from-c-/#/schema/breadcrumb/1"},"primaryImageOfPage":{"@id":"/blog/three-things-that-java-could-learn-from-c-/#/schema/image/2"},"inLanguage":"en-US","potentialAction":[{"@type":"ReadAction","target":["/blog/three-things-that-java-could-learn-from-c-/"]}]},{"@type":"BreadcrumbList","@id":"/blog/three-things-that-java-could-learn-from-c-/#/schema/breadcrumb/1","name":"Breadcrumbs","itemListElement":[{"@type":"ListItem","position":1,"item":{"@type":"WebPage","@id":"/","url":"/","name":"Home"}},{"@type":"ListItem","position":2,"item":{"@id":"/blogthree-things-that-java-could-learn-from-c-/"}}]},{"@context":"https://schema.org","@graph":[{"@type":"Article","@id":"/#/schema/article/1","headline":"Three things that Java could learn from C\u002b\u002b","description":"","isPartOf":{"@id":"/blog/three-things-that-java-could-learn-from-c-/"},"mainEntityOfPage":{"@id":"/blog/three-things-that-java-could-learn-from-c-/"},"datePublished":"2008-11-08T16:03:00CET","dateModified":"2008-11-08T17:48:32CET","author":{"@id":"/#/schema/person/2"},"publisher":{"@id":"/#/schema/organization/1"},"image":{"@id":"/blog/three-things-that-java-could-learn-from-c-/#/schema/image/2"}}]},{"@context":"https://schema.org","@graph":[{"@type":"Person","@id":"/#/schema/person/2","name":null,"sameAs":[]}]},{"@context":"https://schema.org","@graph":[{"@type":"ImageObject","@id":"/blog/three-things-that-java-could-learn-from-c-/#/schema/image/2","url":"/img/logo.png","contentUrl":"/img/logo.png","caption":"Three things that Java could learn from C\u002b\u002b"}]}]}</script><meta name=theme-color content="#fff"><link rel=icon href=/favicon.ico sizes=any><link rel=icon type=image/svg+xml href=/favicon.svg><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest crossorigin=use-credentials href=/site.webmanifest></head><body class="blog single"><div class=sticky-top><div class=header-bar></div><header class="navbar navbar-expand-md navbar-light doks-navbar"><nav class="container-fluid flex-wrap flex-md-nowrap" aria-label="Main navigation"><a class="navbar-brand p-0 me-auto" href=/ aria-label=Aegisub>Aegisub
</a><button class="btn btn-menu d-block d-md-none order-5" type=button data-bs-toggle=offcanvas data-bs-target=#offcanvasDoks aria-controls=offcanvasDoks aria-label="Open main menu"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"><line x1="3" y1="12" x2="21" y2="12"/><line x1="3" y1="6" x2="21" y2="6"/><line x1="3" y1="18" x2="21" y2="18"/></svg></button><div class="offcanvas offcanvas-end border-0 py-md-1" tabindex=-1 id=offcanvasDoks data-bs-backdrop=true aria-labelledby=offcanvasDoksLabel><div class="header-bar d-md-none"></div><div class="offcanvas-header d-md-none"><h2 class="h5 offcanvas-title ps-2" id=offcanvasDoksLabel><a class=text-dark href=/>Aegisub</a></h2><button type=button class="btn-close text-reset me-2" data-bs-dismiss=offcanvas aria-label="Close main menu"></button></div><div class="offcanvas-body px-4"><h3 class="h6 text-uppercase mb-3 d-md-none">Main</h3><ul class="nav flex-column flex-md-row ms-md-n3"><li class=nav-item><a class="nav-link ps-0 py-1" href=/downloads/>Downloads</a></li><li class=nav-item><a class="nav-link ps-0 py-1" href=/docs/>Docs</a></li><li class=nav-item><a class="nav-link ps-0 py-1" href=https://github.com/Aegisub/Aegisub/issues>Bug Tracker</a></li><li class=nav-item><a class="nav-link ps-0 py-1 active" href=/blog/>Blog</a></li></ul><hr class="text-black-50 my-4 d-md-none"><h3 class="h6 text-uppercase mb-3 d-md-none">Socials</h3><ul class="nav flex-column flex-md-row ms-md-auto me-md-n5 pe-md-4"><li class=nav-item><a class="nav-link ps-0 py-1" href=https://github.com/Aegisub/Aegisub aria-label="View repository on GitHub"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-github"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37.0 00-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44.0 0020 4.77 5.07 5.07.0 0019.91 1S18.73.65 16 2.48a13.38 13.38.0 00-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07.0 005 4.77 5.44 5.44.0 003.5 8.55c0 5.42 3.3 6.61 6.44 7A3.37 3.37.0 009 18.13V22"/></svg><small class="ms-2 d-md-none">GitHub</small></a></li></ul></div></div><button id=mode class="btn btn-link order-md-1" type=button aria-label="Toggle user interface mode">
<span class=toggle-dark><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-moon"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg></span><span class=toggle-light><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-sun"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></span></button><div class="dropdown order-md-2"><button class="btn btn-doks-light dropdown-toggle" id=doks-languages data-bs-toggle=dropdown aria-expanded=false data-bs-display=static>
EN
<span class=dropdown-caret><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-down"><polyline points="6 9 12 15 18 9"/></svg></span></button><ul class="dropdown-menu dropdown-menu-end shadow rounded border-0" aria-labelledby=doks-languages><li><a class="dropdown-item current" aria-current=true href=/blog/three-things-that-java-could-learn-from-c-/>English</a></li><li><hr class=dropdown-divider></li><li><a class=dropdown-item rel=alternate href=/zh-cn hreflang=zh-cn lang=zh-cn>简体中文</a></li></ul></div></nav></header></div><div class="wrap container-fluid" role=document><div class=content><div class="row justify-content-center"><div class="col-md-12 col-lg-10 col-xl-8"><article><div class=blog-header><h1>Three things that Java could learn from C++</h1><p><small>Posted November 8, 2008 by <a class="stretched-link position-relative" href=/contributors/unknown/>Unknown</a>&nbsp;&dash;&nbsp;<strong>5&nbsp;min read</strong></small><p></div><p class=lead></p><p>This is a mostly off-topic rant that is being posted because I know that a good portion of our user base is composed of programmers.</p><p>Ever since I started working with Java, a few months ago, there have been many things that I have felt SHOULD be there, but aren&rsquo;t. Three, in particular, have always bothered me: <strong>stack building</strong>, <strong>operator overloading</strong>, and <strong>const-correctness</strong>. For the rest of this post, I will write snippets in both C++ and in Java to illustrate the differences.</p><p><strong>1. Stack building</strong>
Creating objects on the heap is slow. Not only does it involve complex algorithms for determining WHERE to allocate the memory, but it also means that you&rsquo;re giving more work for the garbage collector when you&rsquo;re done with the object. In many situations, you will have to allocate many small temporary objects and then never use them again. Stack building makes this much faster, not to mention EASIER. Since Java lacks this feature, you are forced to use annoying workarounds (such as keeping pools of objects) if performance becomes critical.</p><p><em>C++:</em></p><pre><code class=language-cpp>bool isNormalPointingAt(Vector3f a,Vector3f b, Vector3f dir) {
    return (a.cross(b).dot(dir) &gt; 0);
}
</code></pre><p><em>Java:</em></p><pre><code class=language-java>boolean isNormalPointingAt(Vector3f a,Vector3f b, Vector3f dir) {
    Vector3f normal = new Vector3f();
    normal.cross(a,b);
    return (normal.dot(dir) &gt; 0);
}
</code></pre><p>In the above C++ example, the result of a.cross(b) is stored in a temporary variable in the stack, which is then dot()ed with dir. This could be done in Java if every such method allocated a new instance, but that would quickly become prohibitively slow.</p><p><strong>2. Operator Overloading</strong>
This is a hotly debated topic. Many people insist that operator overloading can lead to unreadable code, if you start overloading operators to perform things that are illogical - but the same is true for method names, you can have an &ldquo;add()&rdquo; method that performs a multiplication. However, especially when working with mathematical vectors, operator overloading makes your code way easier to understand. Bellow is a method that, given 4 control points and a &ldquo;t&rdquo; parameter in the range [0,1], finds the corresponding point along a cubic Bézier curve:</p><p><em>C++:</em></p><pre><code class=language-cpp>Vector3f getBezierCubicPoint(Vector3f a, Vector3f b,
        Vector3f c, Vector3f d, float t) {
    float u = 1-t;
    return (u*u*u)*a + (u*u*t)*b + (u*t*t)*c + (t*t*t)*d;
}
</code></pre><p><em>Java:</em></p><pre><code class=language-java>Vector3f getBezierCubicPoint(Vector3f a, Vector3f b,
        Vector3f c, Vector3f d, float t) {
    float u = 1-t;
    Vector3f result = new Vector3f();
    Vector3f tmp = new Vector3f();
    tmp.scale(u*u*u, a);
    result.add(tmp);
    tmp.scale(u*u*t, b);
    result.add(tmp);
    tmp.scale(u*t*t, c);
    result.add(tmp);
    tmp.scale(t*t*t, d);
    result.add(tmp);
    return result;
}
</code></pre><p>&lt;sarcasm>Yeah, operator overloading really made that code a <em>lot</em> harder to read&mldr;&lt;/sarcasm> Operator overloading is a tool. It can be very useful, as the example above demonstrates. I don&rsquo;t think that the language designers should remove that power from their users just because some won&rsquo;t know how to use it wisely.</p><p><strong>3. Const-correctness</strong>
This one is possibly even more infuriating than the above two points, because it makes proper encapsulation of data much more complicated (not to mention slower). Consider this class in C++ and Java:</p><p><em>C++:</em></p><pre><code class=language-cpp>class Body {
public:
    const Vector3f&amp; getPosition() const {
        return position;
    }
    void setPosition(const Vector3f&amp; pos) {
        position = pos;
    }

private:
    Vector3f position;
};
</code></pre><p><em>Java:</em></p><pre><code class=language-java>public class Body {
    public Vector3f getPosition() {
        return position;
    }
    public void setPosition(Vector3f pos) {
        position = pos;
    }
    private Vector3f position = new Vector3f();
}
</code></pre><p>What&rsquo;s wrong with the above example? Here, let me illustrate it with some code:</p><p><em>C++:</em></p><pre><code class=language-cpp>Body body;
body.getPosition().x = 5.0f; // compile error
</code></pre><p><em>Java:</em></p><pre><code class=language-java>Body body = new Body();
body.getPosition().x = 5.0f; // works
</code></pre><p>Basically, Java allows you to modify an object&rsquo;s private member without using its &ldquo;set&rdquo; method! There is no way to declare that a given object is &ldquo;read-only&rdquo; (final only means that the reference can&rsquo;t be reassigned), so you can&rsquo;t prevent that code from working. If you really must be sure that position can&rsquo;t be modified like that, then you have to change your Java class to this:</p><p><em>Java:</em></p><pre><code class=language-java>public class Body {
    public Vector3f getPosition() {
        return (Vector3f)position.clone();
    }
    public void setPosition(Vector3f pos) {
        position = (Vector3f)pos.clone();
    }
    private Vector3f position = new Vector3f();
}
</code></pre><p>In other words, you&rsquo;re now returning a full copy of the object. There are two major problems with this: First, the previous code STILL COMPILES. Since the user will have no way to tell if he&rsquo;s getting the actual position or a copy of it (unless he enters the original source or look in the documentation), he might try to modify the position that he got, and then be surprised that it doesn&rsquo;t work. The second problem is that returning an entire copy might be SLOW. What if, instead of a vector, it was an image? And what if it was accessed many times per second? This could quickly become impossibly slow. Java offers no solution for this problem.</p><p>(In case you&rsquo;re wondering, I also had to add a clone() to the set method, because otherwise the caller might call the set method, but keep the reference that it passed to it and modify it later.)</p><p><strong>Conclusion</strong>
While many programs don&rsquo;t suffer from those problems much, there are certain applications that become a true nightmare to write and maintain - physics simulations or anything to do with vectorial math are the obvious example (that&rsquo;s why I kept using &ldquo;Vector3f&rdquo; classes above). If Java is supposed to be a cleaner and easier version of C++, then why is it that writing that sort of code in Java is much harder and much less robust?</p><p>I am aware that C# supports some (all?) of the above, but it doesn&rsquo;t as yet have as much portability as Java does. Indeed, it seems that C# is what Java SHOULD HAVE BEEN. If Sun doesn&rsquo;t start fixing this sort of thing in Java, then Microsoft just might take the lead. Meanwhile, I&rsquo;ll have to stick to writing that kind of abomination in Java. To think that it&rsquo;s much easier to code this sort of thing in
C++&mldr;</p></article></div></div></div></div><footer class="footer text-muted"><div class=container-fluid><div class=row><div class="col-lg-8 order-last order-lg-first"><ul class=list-inline><li class=list-inline-item>Powered by <a class=text-muted href=https://gohugo.io/>Hugo</a> and <a class=text-muted href=https://getdoks.org/>Doks</a>.<br>Copyright (c) AegiSite <a href=https://github.com/Aegisub/aegisite/graphs/contributors>contributors</a>.</li></ul></div><div class="col-lg-8 order-first order-lg-last text-lg-end"><ul class=list-inline><li class=list-inline-item><a href=/privacy-policy/>Privacy</a></li></ul></div></div></div></footer><script src=/js/bootstrap.min.5a6f7686a75311832f9f1feed99f35019d824bf8b16fb67dd245d71ba2ac41ef01d924cad506ad7a1432fb579700210c4704c92242a4f97bea71b5f5ac14e506.js integrity="sha512-Wm92hqdTEYMvnx/u2Z81AZ2CS/ixb7Z90kXXG6KsQe8B2STK1QatehQy+1eXACEMRwTJIkKk+XvqcbX1rBTlBg==" crossorigin=anonymous defer></script><script src=/js/highlight.min.d630cc4574996a818cbdbd5afead8769c9eab7d78e246d788b1f528b488e569aa8fc430a90ce1c215cd081f313a001e1fe68697ab68abe0482784f1a361d1703.js integrity="sha512-1jDMRXSZaoGMvb1a/q2Hacnqt9eOJG14ix9Si0iOVpqo/EMKkM4cIVzQgfMToAHh/mhperaKvgSCeE8aNh0XAw==" crossorigin=anonymous defer></script><script src=/main.min.7a18882f4fe145c62fd85456a9819b35aa7789857e97e862e92d93552fdd70a8b1b6c059d624387ca658ddf11203732f358d21737a0dbc03f6dce91938e85253.js integrity="sha512-ehiIL0/hRcYv2FRWqYGbNap3iYV+l+hi6S2TVS/dcKixtsBZ1iQ4fKZY3fESA3MvNY0hc3oNvAP23OkZOOhSUw==" crossorigin=anonymous defer></script></body></html>